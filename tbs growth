
I appreciate your patience. If `SNAP_ID` is not directly available in `DBA_TABLESPACE_USAGE_METRICS`, you might need to use `DBA_HIST_TBSPC_SPACE_USAGE` for historical tablespace information and join it with `DBA_HIST_SNAPSHOT`. Here's an adjusted query:

```sql
SELECT TABLESPACE_NAME,
       TO_CHAR(MAX(BEGIN_INTERVAL_TIME), 'YYYY-MM') AS MONTH,
       ROUND(MAX(TABLESPACE_SIZE) / 1024 / 1024, 2) AS MAX_SIZE_MB,
       ROUND(MAX(TABLESPACE_USEDSIZE) / 1024 / 1024, 2) AS USED_SIZE_MB,
       ROUND(MAX(TABLESPACE_USEDSIZE - TABLESPACE_FREE) / 1024 / 1024, 2) AS FREE_SIZE_MB,
       ROUND(MAX((TABLESPACE_USEDSIZE / TABLESPACE_SIZE) * 100), 2) AS USED_PERCENTAGE
FROM DBA_HIST_TBSPC_SPACE_USAGE U
JOIN DBA_HIST_SNAPSHOT S ON U.SNAP_ID = S.SNAP_ID
GROUP BY TABLESPACE_NAME, TO_CHAR(BEGIN_INTERVAL_TIME, 'YYYY-MM')
ORDER BY TABLESPACE_NAME, TO_CHAR(BEGIN_INTERVAL_TIME, 'YYYY-MM');
```

This query assumes that the relevant information is available in `DBA_HIST_TBSPC_SPACE_USAGE`. Adjust the column names based on your database schema if needed.
